<project name="HudsonBuild" default="deploywars" basedir=".">
    <description>
        Hudson Build file
    </description>
  <!-- set global properties for this build -->
  <property name="src" location="src"/>
  <property name="build" location="build"/>
  <property name="dist"  location="dist"/>
  <property name="catalina.home" value="C:\Program Files\Apache Software Foundation\Tomcat6.0"/>
  <property name="repo.path" value="C:\Project\Mootly\cmsrepositories\indiantaxonline"/>
  <property environment="env" /> <!-- get Hudson environment -->

  <target name="stoptomcat">
    <!-- Create the time stamp -->
    <tstamp/>
    <exec executable="cmd">
    	<arg value="/c"/>
    	<arg value="net"/>
	<arg value="stop"/>
	<arg value="Tomcat6"/>
    </exec>
  </target>

  <target name="copywars" depends="stoptomcat"
        description="compile the source " >
    <echo message="Copying ${env.WORKSPACE}/site/target/site.war to ${catalina.home}/webapps/ ${env.BUILD_TAG}"/>
    <copy file="${env.WORKSPACE}/site/target/site.war" toDir="${catalina.home}/webapps/" overwrite="true"/>
<echo message="Copying ${env.WORKSPACE}/site/target/site.war to ${catalina.home}/webapps/ ${env.BUILD_TAG}"/>
    <copy file="${env.WORKSPACE}/cms/target/cms.war" toDir="${catalina.home}/webapps/" overwrite="true"/>
  </target>


 <target name="cleantomcatcache" depends="copywars"
        description="compile the source " >
    <echo message="Deleting Tomcat cache"/>
    <delete dir="${catalina.home}/work/Catalina" quiet="true"/>
	<delete dir="${catalina.home}/webapps/site" quiet="true"/>
	<delete dir="${catalina.home}/webapps/cms" quiet="true"/>
  </target>

  <target name="starttomcat" depends="cleantomcatcache">
    <!-- Create the time stamp -->
    <tstamp/>
    <exec executable="cmd">
    	<arg value="/c"/>
    	<arg value="net"/>
	<arg value="start"/>
	<arg value="Tomcat6"/>
    </exec>
  </target>

  <target name="deploywars" depends="starttomcat">
    <!-- Create the time stamp -->
    <echo message="Deploying new WARs"/>
  </target>

  <target name="removerepository" depends="deploywars">
    <!-- Create the time stamp -->
    <delete includeemptydirs="true">
    	<fileset dir="${repo.path}" includes="**/*"/>
    </delete>
  </target>

  <target name="deploywarsclean" depends="removerepository">
    <!-- Create the time stamp -->
    <echo message="Deploying new WARs"/>
  </target>

</project>